<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="./json.svg" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>json-editor-vue</title>
    <link rel="stylesheet" href="https://qidian.gtimg.com/lulu/edge/css/common/ui/Radio.css" />
    <link rel="stylesheet" href="https://qidian.gtimg.com/lulu/edge/css/common/ui/Checkbox.css" />
    <link rel="stylesheet" href="https://qidian.gtimg.com/lulu/edge/css/common/ui/Input.css" />
    <link rel="stylesheet" href="https://qidian.gtimg.com/lulu/edge/css/common/ui/Textarea.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vanilla-jsoneditor/themes/jse-theme-dark.css" />
    <!-- <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/lu2/theme/edge/css/common/ui/LightTip.css"
    /> -->
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
        padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom)
          env(safe-area-inset-left);
      }

      #app {
        width: calc(100% - 32px);
        padding-top: 16px;
        padding-bottom: 16px;
        max-width: 670px;
        margin: auto;
      }

      .options {
        margin-bottom: 1rem;
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
      }

      .options > span {
        flex-shrink: 0;
      }

      .options label,
      .options input {
        cursor: pointer;
        margin-left: 0;
      }

      .options p {
        border: 1px solid #d7d7d7;
        padding: 3rem 1rem 1rem 1rem;
        position: relative;
        word-break: break-all;
      }

      .options p:before {
        content: 'Binding value';
        position: absolute;
        top: 1rem;
        left: 1rem;
        font-weight: bold;
      }

      /* ui-lighttip {
        top: unset;
        bottom: 16px;
      } */
    </style>
  </head>

  <body>
    <div id="app">
      <div class="options">
        <span
          style="display: flex; align-items: center; cursor: pointer; position: relative"
          @click="() => {
            window.open('https://www.npmjs.com/package/json-editor-vue?activeTab=versions')
          }"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256">
            <path fill="#C12127" d="M0 256V0h256v256z" />
            <path fill="#FFF" d="M48 48h160v160h-32V80h-48v128H48z" />
          </svg>
          <label style="margin-left: 5px" for="npm-downloads"> npm downloads </label>
          <input
            style="margin-left: 5px"
            class="ui-input"
            readonly
            :value="statistics.npmDownloads"
            id="npm-downloads"
          />
          <span
            style="
              position: absolute;
              display: flex;
              align-items: center;
              bottom: 2px;
              right: 4px;
              font-size: 12px;
              color: -webkit-link;
              cursor: pointer;
              text-decoration: underline;
            "
            @click.stop="() => {
              window.open('https://npm.chart.dev/json-editor-vue')
            }"
          >
            Total
          </span>
        </span>
        <span
          style="display: flex; align-items: center; cursor: pointer; position: relative"
          @click="() => {
            window.open('https://npmmirror.com/package/json-editor-vue/trends')
          }"
        >
          <img src="https://npmmirror.com/cnpm.png" style="width: 16px; height: 16px" />
          <label style="margin-left: 5px" for="cnpm-downloads"> cnpm downloads </label>
          <input
            style="margin-left: 5px"
            class="ui-input"
            readonly
            :value="statistics.cnpmDownloads"
            id="cnpm-downloads"
          />
        </span>
        <span
          style="display: flex; align-items: center; cursor: pointer"
          @click="() => {
            window.open('https://www.jsdelivr.com/package/npm/json-editor-vue')
          }"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 273">
            <path fill="#E14337" d="M126.517 0L256 45.398l-19.667 167.398l-109.816 60.021l-108.811-60.102L0 45.422z" />
            <path
              fill="#F9BD3E"
              d="M174.235 140.62a7.467 7.467 0 0 1-7.467 7.466a7.467 7.467 0 1 1 7.467-7.466M129.68 93.85a7.466 7.466 0 1 1-14.933 0a7.466 7.466 0 0 1 14.933 0m-1.969-12.639c9.104-9.002 19.144-16.759 29.379-22.47a76.784 76.784 0 0 0-30.323-6.205c-5.039 0-9.961.5-14.731 1.424c.863 7.608 3.7 16.714 8.198 26.263a13.894 13.894 0 0 1 1.98-.158c1.955 0 3.812.412 5.497 1.146M88.907 151.76c.711-5.656 2.044-11.461 4.049-17.382c3.799-11.214 9.948-22.554 17.618-33.165a13.73 13.73 0 0 1 1.733-16.936c-4.688-9.881-7.802-19.551-8.936-28.113C72.26 66.071 49.72 95.19 49.72 129.583c0 2.254.118 4.479.307 6.684c9.542 11.564 20.334 18.108 31.005 21.5a13.792 13.792 0 0 1 7.875-6.007m43.017-36.592a158.953 158.953 0 0 1-6.096-8.029a13.732 13.732 0 0 1-3.614.495c-1.689 0-3.3-.318-4.796-.874c-6.98 9.76-12.581 20.166-16.069 30.461c-1.487 4.391-2.809 9.473-3.555 14.946a13.813 13.813 0 0 1 8.097 8.637a84.18 84.18 0 0 0 8.135-.801c13.701-2.017 27.372-7.369 39.685-14.988a13.751 13.751 0 0 1-.728-4.396c0-1.294.192-2.542.525-3.73c-7.1-5.738-14.378-12.859-21.584-21.721m1.245-12.976c7.042 9.891 15.605 19.4 25.364 27.392a13.7 13.7 0 0 1 8.235-2.749c2.729 0 5.266.803 7.406 2.171c9.813-9.608 17.616-20.733 22.215-32.446a77.378 77.378 0 0 0-29.64-32.85c-11.275 5.353-22.49 13.561-32.515 23.403a13.715 13.715 0 0 1 1.764 6.737c0 3.139-1.061 6.024-2.829 8.342m47.07 41.338c6.597 3.143 13.523 5.5 20.722 6.818a77.099 77.099 0 0 0 2.854-20.765a77.046 77.046 0 0 0-3.029-21.38c-5.209 9.957-12.464 19.349-21.092 27.664c.546 1.483.859 3.079.859 4.752c0 1-.112 1.972-.314 2.911M79.041 166.35c-9.512-2.946-18.26-7.782-26.015-14.413c7.526 24.86 27.276 44.393 52.259 51.636c-3.462-3.402-6.25-6.861-8.375-10.409a59.624 59.624 0 0 1-6.266-14.569c-6.167-.951-10.988-5.973-11.603-12.245m79.999-14.316c-13.536 8.524-28.616 14.512-43.724 16.736a92.24 92.24 0 0 1-9.61.907a13.814 13.814 0 0 1-6.288 7.378a50.683 50.683 0 0 0 5.094 11.555c3.637 6.071 9.755 11.978 18.568 17.927c1.222.058 2.451.094 3.687.094c32.212 0 59.793-19.775 71.302-47.841c-6.279-1.28-13.928-3.591-22.368-7.683a13.718 13.718 0 0 1-8.933 3.297c-2.864 0-5.524-.874-7.728-2.37m-58.816 12.955a7.467 7.467 0 1 1-14.934 0a7.467 7.467 0 0 1 14.934 0"
            />
            <path fill="#440401" fill-opacity=".3" d="M256 45.398L126.517 0v272.817l109.816-60.021z" />
          </svg>
          <label style="margin-left: 5px" for="jsDelivr-downloads"> jsDelivr downloads </label>
          <input
            style="margin-left: 5px"
            class="ui-input"
            readonly
            :value="statistics.jsDelivrDownloads"
            id="jsDelivr-downloads"
          />
        </span>
        <span
          style="display: flex; align-items: center; cursor: pointer"
          @click="() => {
            window.open('https://jsr.io/@cloydlau/json-editor-vue')
          }"
        >
          <img src="https://github.com/jsr-io/jsr/blob/main/frontend/static/logo.png?raw=true" style="width: 16px" />
          <label style="margin-left: 5px" for="jsr-downloads"> JSR downloads </label>
          <input
            style="margin-left: 5px"
            class="ui-input"
            readonly
            :value="statistics.jsrDownloads"
            id="jsr-downloads"
          />
        </span>
        <span
          style="display: flex; align-items: center; cursor: pointer"
          @click="() => {
            window.open('https://github.com/mjackson/unpkg/issues/250')
          }"
        >
          <img src="https://www.unpkg.com/favicon.jpg" style="width: 16px; height: 16px" />
          <label style="margin-left: 5px" for="unpkg-downloads"> unpkg downloads </label>
          <input
            style="margin-left: 5px"
            class="ui-input"
            readonly
            :value="statistics.unpkgDownloads"
            id="unpkg-downloads"
          />
        </span>
        <span
          style="display: flex; align-items: center; cursor: pointer"
          @click="() => {
            window.open(`https://github.com/cloydlau/${name}`)
          }"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
            <path
              fill="currentColor"
              d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"
            />
          </svg>
          <span style="position: relative">
            <label style="margin-left: 5px" for="GitHub-Stars"> GitHub Stars </label>
          </span>
          <span style="position: relative">
            <input
              style="margin-left: 5px"
              class="ui-input"
              readonly
              :value="statistics.githubStars"
              id="GitHub-Stars"
            />
            <span
              style="
                position: absolute;
                top: 2px;
                right: 4px;
                font-size: 12px;
                display: flex;
                align-items: center;
                color: -webkit-link;
                cursor: pointer;
                text-decoration: underline;
              "
              @click.stop="() => {
                window.open(`https://github.com/cloydlau/${name}/network/dependents`)
              }"
            >
              Dependents
            </span>
            <span
              style="
                position: absolute;
                bottom: 2px;
                right: 4px;
                font-size: 12px;
                color: -webkit-link;
                cursor: pointer;
                text-decoration: underline;
              "
              @click.stop="() => {
                window.open(`https://github.com/search?q=%22${name}%22%3A+path%3Apackage.json&type=code`)
              }"
            >
              <span style="display: flex; align-items: center"> package.json usage </span>
            </span>
          </span>
        </span>
        <!-- <span
          style="display: flex; align-items: center; cursor: pointer"
          @click="() => {
            window.open(`https://github.com/cloydlau/${name}`)
          }"
        >
          <img src="https://arethetypeswrong.github.io/icons/android-chrome-512x512.png" style="width: 16px">
          <span style="position: relative">
            <label style="margin-left: 5px" for="attw">Are the types wrong?</label>
          </span>
          <span style="position: relative">
            <input
              style="margin-left: 5px"
              class="ui-input"
              readonly
              id="attw"
            />
            <span
              style="
                position: absolute;
                top: 11px;
                right: 110px;
                font-size: 12px;
                display: flex;
                align-items: center;
                color: -webkit-link;
                cursor: pointer;
                text-decoration: underline;
              "
              @click.stop="() => {
                window.open(`https://arethetypeswrong.github.io/?p=${name}`)
              }"
            >
              Analyze
            </span>
        </span> -->
      </div>
      <hr style="background-color: #d3d8dc; border: none; height: 1px; margin-bottom: 16px" />
      <div class="options">
        <span>
          <input type="radio" is="ui-radio" id="light" value="light" v-model="theme" />
          <label for="light">Light Theme</label>
        </span>
        <span>
          <input type="radio" is="ui-radio" id="dark" value="dark" v-model="theme" />
          <label for="dark">Dark Theme</label>
        </span>
      </div>
      <div class="options">
        <span>
          <input type="radio" is="ui-radio" id="text" value="text" v-model="mode" />
          <label for="text">Text Mode</label>
        </span>
        <span>
          <input type="radio" is="ui-radio" id="tree" value="tree" v-model="mode" />
          <label for="tree">Tree Mode</label>
        </span>
        <span>
          <input type="radio" is="ui-radio" id="table" value="table" v-model="mode" />
          <label for="table">Table Mode</label>
        </span>
      </div>
      <div class="options">
        <span>
          <input type="checkbox" is="ui-checkbox" id="readOnly" v-model="readOnly" />
          <label for="readOnly">readOnly</label>
        </span>
        <span>
          <input type="checkbox" is="ui-checkbox" id="mainMenuBar" v-model="mainMenuBar" />
          <label for="mainMenuBar">mainMenuBar</label>
        </span>
        <span v-show="mode === 'text'" v-cloak>
          <input type="checkbox" is="ui-checkbox" id="statusBar" v-model="statusBar" />
          <label for="statusBar">statusBar</label>
        </span>
        <span v-show="mode === 'tree'" v-cloak>
          <input type="checkbox" is="ui-checkbox" id="navigationBar" v-model="navigationBar" />
          <label for="navigationBar">navigationBar</label>
        </span>
        <span v-show="mode === 'text'" v-cloak>
          <input type="checkbox" is="ui-checkbox" id="stringified" v-model="stringified" />
          <label for="stringified">stringified</label>
        </span>
      </div>
      <json-editor-vue
        style="height: 440px"
        :class="className"
        v-model="value"
        v-model:mode="mode"
        :read-only="readOnly"
        :main-menu-bar="mainMenuBar"
        :navigation-bar="navigationBar"
        :status-bar="statusBar"
        :stringified="stringified"
        :parser="parser"
      >
        <div style="height: 438px; border: 1px solid lightgrey"></div>
      </json-editor-vue>
      <div style="margin-top: 1rem">
        <div style="display: flex; align-items: center; justify-content: space-between">
          <label for="binding-value"> 2-Way Binding Value<span v-text="` (${typeof value})`"></span>: </label>
          <button
            style="width: 62px"
            @click="() => {
              window.navigator.clipboard.writeText(valueComputed)
              const copyButton=document.querySelector('#copyButton')
              copyButton.innerText = 'Copied!'
              if (timeoutID) {
                window.clearTimeout(timeoutID)
                timeoutID = null
              }
              timeoutID = window.setTimeout(() => {
                copyButton.innerText = 'Copy'
                timeoutID = null
              }, 500)
            }"
            id="copyButton"
          >
            Copy
          </button>
        </div>
        <textarea
          class="ui-textarea"
          name="binding-value"
          v-model="valueComputed"
          width="100%"
          style="height: 150px; border-radius: 0"
          rows="10"
        ></textarea>
      </div>
    </div>

    <script type="importmap">
      {
        "imports": {
          "vue": "https://cdn.jsdelivr.net/npm/vue/dist/vue.esm-browser.prod.js",
          "vue-demi": "https://cdn.jsdelivr.net/npm/vue-demi/lib/v3/index.mjs",
          "vanilla-jsoneditor": "https://cdn.jsdelivr.net/npm/vanilla-jsoneditor",
          "json-editor-vue": "https://cdn.jsdelivr.net/npm/json-editor-vue@latest/dist/json-editor-vue.mjs",
          "lossless-json": "https://cdn.jsdelivr.net/npm/lossless-json/lib/esm/index.js"
        }
      }
    </script>
    <script type="module">
      import { createApp, ref, computed } from 'vue'
      import JsonEditorVue from 'json-editor-vue'
      import { parse, stringify } from 'lossless-json'
      import getStatistics from './getStatistics.js'
      // import LightTip from 'https://cdn.jsdelivr.net/npm/lu2/theme/edge/js/common/ui/LightTip.js'

      const name = 'json-editor-vue'
      const latestVersion = ref()

      fetch(`https://cdn.jsdelivr.net/npm/${name}@latest/dist/${name}.mjs`).then((res) => {
        latestVersion.value = res.headers.get('X-Jsd-Version')
        document.title = `${name}@${latestVersion.value}`
      })

      /* new LightTip(
        'You can access this page on mobile devices, <br>or enable device toolbar in the browser devtool.',
        {
          time: 5000,
        },
      ) */

      const parser = { parse, stringify }

      const app = createApp({
        setup: () => {
          const value = ref({
            bigint: 124124124124124124124n,
            symbol: Symbol('foo'),
            boolean: true,
            number: 123.456,
            string: 'Hello World!',
            null: null,
            time: 1575599819000,
            color: '#b0a4e3',
            undefined: undefined,
            array: [1, 2],
            record: {
              a: 'b',
              c: 'd',
            },
          })

          const className = computed(() => (theme.value === 'dark' ? 'jse-theme-dark' : undefined))
          const theme = ref('light')
          const mode = ref('text')
          const readOnly = ref(false)
          const mainMenuBar = ref(false)
          const navigationBar = ref(false)
          const statusBar = ref(false)
          const stringified = ref(false)
          const valueComputed = computed({
            get() {
              return parser.stringify(value.value)
            },
            set(newValue) {
              value.value = parser.parse(newValue)
            },
          })
          const statistics = ref({})
          getStatistics().then((value) => {
            statistics.value = value
          })
          const timeoutID = ref()

          return {
            className,
            value,
            theme,
            mode,
            readOnly,
            mainMenuBar,
            navigationBar,
            statusBar,
            parser,
            stringified,
            valueComputed,
            statistics,
            window,
            document,
            name,
            latestVersion,
            timeoutID,
          }
        },
      })
      app.config.compilerOptions.whitespace = 'preserve'
      app.use(JsonEditorVue).mount('#app')
    </script>
  </body>
</html>
